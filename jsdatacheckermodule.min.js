if (typeof define !== 'function') { var define = require('amdefine')(module) } 
define(function (require, exports, module) { 
function ArrayUtils(){}function DataTypeConverter(){this._fields=[],this._numOfRows=0}function DataTypesUtils(){}function DataTypeHierarchy(){}ArrayUtils.TestAndSet=function(arr,key,object){return void 0===arr?null:0==Array.isArray(arr)?null:(void 0===arr[key]&&(arr[key]=object),arr[key])},ArrayUtils.TestAndInitializeKey=function(obj,key,value){return void 0===obj?null:(void 0===obj[key]&&(obj[key]=value),obj[key])},ArrayUtils.TestAndIncrement=function(arr,key){return void 0===arr[key]&&(arr[key]=0),arr[key]++,arr},ArrayUtils.toFieldsArray=function(obj){var fields=[];return ArrayUtils.IteratorOverKeys(obj,function(field,key){field.key=key,fields.push(field)}),fields},ArrayUtils.IteratorOverKeys=function(arr,callback){for(var property in arr){if(arr.hasOwnProperty(property))callback(arr[property],property)}},ArrayUtils.FindMinMax=function(arr,fncompare){var max1=null,max2=null;for(var key in arr)null==max1||fncompare(arr[key],max1.value)?(max2=max1,max1={index:-1,key:key,value:arr[key]}):(null==max2||fncompare(arr[key],max2.value))&&(max2={index:-1,key:key,value:arr[key]});return{first:max1,second:max2}},ArrayUtils.isArray=function(arr){return!!Array.isArray(arr)&&0<arr.length},DataTypeConverter.TYPES={EMPTY:{value:0,name:"NULL"},TEXT:{value:1,name:"TEXT"},NUMBER:{value:2,name:"NUMBER"},OBJECT:{value:3,name:"OBJECT"},DATETIME:{value:4,name:"DATETIME"}},DataTypeConverter.SUBTYPES={GEOCOORDINATE:{value:1e3,name:"GEOCOORDINATE"},GEOJSON:{value:1001,name:"GEOJSON"},BOOL:{value:1002,name:"BOOL"},CONST:{value:1003,name:"CONST"},CATEGORY:{value:1004,name:"CATEGORY"},LATITUDE:{value:1101,name:"LATITUDE"},LONGITUDE:{value:1102,name:"LONGITUDE"},DATETIMEYM:{value:1200,name:"DATETIMEYM"},DATETIMEYMD:{value:1201,name:"DATETIMEYMD"},DATETIMEDMY:{value:1202,name:"DATETIMEDMY"},DATETIMEMDY:{value:1203,name:"DATETIMEMDY"},DATETIMEXXY:{value:1203,name:"DATETIMEXXY"},NUMINTEGER:{value:1300,name:"INTEGER"},NUMREAL:{value:1300,name:"REAL"},PERCENTAGE:{value:1400,name:"PERCENTAGE"}},DataTypeConverter.LANGS={EN:{value:1e3,name:"EN"},IT:{value:1001,name:"IT"},FR:{value:1100,name:"FR"},NL:{value:1101,name:"NL"}},DataTypeConverter.GEOJSONTYPES=["Point","MultiPoint","LineString","MultiLineString","Polygon","MultiPolygon","GeometryCollection","Feature","FeatureCollection"],DataTypeConverter.prototype=function(){var _processInferType=function(value){if(null==value)return DataTypeConverter.TYPES.EMPTY;if("object"==typeof value)return DataTypeConverter.TYPES.OBJECT;var _datetype,isnumber=DataTypesUtils.FilterNumber(value);return!0!==isNaN(isnumber)?DataTypeConverter.TYPES.NUMBER:null!=(_datetype=DataTypesUtils.FilterDateTime(value))?_datetype:null!=(_datetype=DataTypesUtils.FilterPercentage(value))?_datetype:DataTypeConverter.TYPES.TEXT},_processInferSubType=function(value){if(null==value)return null;if(Array.isArray(value)&&2==value.length&&NaN!=DataTypesUtils.FilterNumber(value[0])&&NaN!=DataTypesUtils.FilterNumber(value[1])&&4<DataTypesUtils.DecimalPlaces(value[0])&&4<DataTypesUtils.DecimalPlaces(value[1]))return DataTypeConverter.SUBTYPES.GEOCOORDINATE;if("string"==typeof value){var split=value.split(",");if(DataTypesUtils.IsLatLng(split[0])&&DataTypesUtils.IsLatLng(split[1]))return DataTypeConverter.SUBTYPES.GEOCOORDINATE}var isnumber=DataTypesUtils.FilterNumber(value);if(!0!==isNaN(isnumber))return-90<=isnumber&&isnumber<=90&&5<=DataTypesUtils.DecimalPlaces(isnumber)?DataTypeConverter.SUBTYPES.GEOCOORDINATE:-180<=isnumber&&isnumber<=180&&5<=DataTypesUtils.DecimalPlaces(isnumber)?DataTypeConverter.SUBTYPES.GEOCOORDINATE:1<(value+"").split(/(,|\.)/g).length?DataTypeConverter.SUBTYPES.NUMREAL:DataTypeConverter.SUBTYPES.NUMINTEGER;if("object"==typeof value&&value.hasOwnProperty("type")){var geotype=value.type;if(DataTypeConverter.GEOJSONTYPES.includes(geotype))return DataTypeConverter.SUBTYPES.GEOJSON}return null},_capitalizeFirstLetter=function(string){return string.charAt(0).toUpperCase()+string.slice(1)};return{constructor:DataTypeConverter,cast:function(metadata,options){return void 0!==options&&null!=options||(options={castThresholdConfidence:1,castIfNull:!1,makeChangesToDataset:!1}),this.convert(metadata,options)},convert:function(metadata,options){var lastRowIndex=0,numOfValues=0,datasetErrors=0;return void 0!==options&&null!=options||(options={castThresholdConfidence:1,castIfNull:!1,makeChangesToDataset:!1}),function(json,fieldKeys,callback){var stack=[],numOfRows=0;for(stack.push({item:json,fieldKeyIndex:0});0<stack.length;){var stackTask=stack.pop(),item=stackTask.item,fieldKeyIndex=stackTask.fieldKeyIndex,fieldKey=fieldKeys[fieldKeyIndex];if("*"!=fieldKey||0!=ArrayUtils.isArray(item))if("*"!=fieldKey||1!=ArrayUtils.isArray(item)){var jsonSubtree=item[fieldKey];if(Array.isArray(jsonSubtree))for(j=0;j<jsonSubtree.length;j++){var jsonItem=jsonSubtree[j];stack.push({item:jsonItem,fieldKeyIndex:fieldKeyIndex+1})}else stack.push({item:jsonSubtree,fieldKeyIndex:fieldKeyIndex+1})}else for(var cell,j=0;j<item.length&&(cell=item[j]);j++)stack.push({item:cell,fieldKeyIndex:fieldKeyIndex}),numOfRows++;else{var sProcessedKeys=fieldKeys.slice(0,fieldKeyIndex).toString();ArrayUtils.IteratorOverKeys(item,function(value,key){var curKey=sProcessedKeys+(0<sProcessedKeys.length?",":"")+key,_value=callback(value,key,curKey,numOfRows);item[key]=_value}),numOfRows++}}}(metadata.dataset,metadata.fieldKeys,function(value,key,traversedKeys,rowIndex){var inferredType=metadata.types[traversedKeys];numOfValues++,lastRowIndex!=rowIndex&&(lastRowIndex=rowIndex,0);var isCast=inferredType.typeConfidence>=options.castThresholdConfidence;if(inferredType.type==DataTypeConverter.TYPES.NUMBER.name&&isCast){if(inferredType.subtype===DataTypeConverter.SUBTYPES.PERCENTAGE.name)if(null==value||void 0===value||0==(value+"").length);else{var dt=DataTypesUtils.FilterPercentage(value);if(void 0!==dt&&"type"in dt)return dt.value}0==isNaN(DataTypesUtils.FilterNumber(value))&&"string"==typeof value&&(value=value.replace(",","."));var number=parseFloat(value);return isNaN(number)?(datasetErrors++,value):number}return value}),metadata.qualityIndex.notNullValues=(numOfValues-0)/numOfValues,metadata.qualityIndex.errors=(numOfValues-datasetErrors)/numOfValues,metadata},inferJsonDataType:function(json,fieldKeys,options){void 0!==options&&null!=options||(options={}),0==options.hasOwnProperty("thresholdConfidence")&&(options.thresholdConfidence=1),0==options.hasOwnProperty("filterOnThresholdConfidence")&&(options.filterOnThresholdConfidence=!0),0==options.hasOwnProperty("language")?options.language=DataTypeConverter.LANGS.EN.name:options.language=options.language.toUpperCase(),0==options.hasOwnProperty("trackCellsForEachType")&&(options.trackCellsForEachType=!1);var stack=[],fieldsType={},numOfRows=0;if(void 0===fieldKeys)throw"IllegalArgumentException: undefined json path to analyse.";for(stack.push({item:json,fieldKeyIndex:0});0<stack.length;){var stackTask=stack.pop(),item=stackTask.item,fieldKeyIndex=stackTask.fieldKeyIndex,fieldKey=fieldKeys[fieldKeyIndex];if("*"!=fieldKey||0!=ArrayUtils.isArray(item))if("*"==fieldKey&&ArrayUtils.isArray(item))for(var cell,j=0;j<item.length&&(cell=item[j]);j++)stack.push({item:cell,fieldKeyIndex:fieldKeyIndex}),numOfRows++;else{var jsonSubtree=item[fieldKey];if(Array.isArray(jsonSubtree))for(j=jsonSubtree.length-1;0<=j;j--){var jsonItem=jsonSubtree[j];stack.push({item:jsonItem,fieldKeyIndex:fieldKeyIndex+1})}else stack.push({item:jsonSubtree,fieldKeyIndex:fieldKeyIndex+1})}else{var sProcessedKeys=fieldKeys.slice(0,fieldKeyIndex).toString();ArrayUtils.IteratorOverKeys(item,function(item,key){var curKey=sProcessedKeys+(0==sProcessedKeys.length?"":",")+key,_label=curKey;if(void 0!==json&&json.hasOwnProperty("fields"))if(void 0!==json.fields[key])_label=json.fields[key].label;else for(var field,iField=0;iField<json.fields.length&&(field=json.fields[iField]);iField++)field.hasOwnProperty("name")&&field.name===key&&field.hasOwnProperty("label")&&(_label=field.label);var fieldType=ArrayUtils.TestAndInitializeKey(fieldsType,curKey,{name:curKey,label:_label,_inferredTypes:[],_inferredSubTypes:[],_inferredValues:[],numOfItems:0});fieldType.numOfItems++;var compundTypeSubtype=_processInferType(item),inferredType=compundTypeSubtype;(compundTypeSubtype.hasOwnProperty("type")&&(inferredType=compundTypeSubtype.type),ArrayUtils.TestAndIncrement(fieldType._inferredTypes,inferredType.name),inferredType===DataTypeConverter.TYPES.TEXT&&ArrayUtils.TestAndIncrement(fieldType._inferredValues,item),options.trackCellsForEachType)&&ArrayUtils.TestAndInitializeKey(fieldType._inferredTypes,inferredType.name+"_cells",[]).push({columnKey:key,rowIndex:numOfRows});var inferredSubType=compundTypeSubtype.hasOwnProperty("subtype")?compundTypeSubtype.subtype:_processInferSubType(item);null!=inferredSubType&&void 0!==inferredSubType&&ArrayUtils.TestAndIncrement(fieldType._inferredSubTypes,inferredSubType.name)}),numOfRows++}}var fields,_numOfRows=0;ArrayUtils.IteratorOverKeys(fieldsType,function(fieldType){fieldType.numOfItems>_numOfRows&&(_numOfRows=fieldType.numOfItems)}),ArrayUtils.IteratorOverKeys(fieldsType,function(fieldType){fieldType._inferredTypes.hasOwnProperty(DataTypeConverter.TYPES.EMPTY.name)||(fieldType._inferredTypes[DataTypeConverter.TYPES.EMPTY.name]=0),fieldType._inferredTypes[DataTypeConverter.TYPES.EMPTY.name]=fieldType._inferredTypes[DataTypeConverter.TYPES.EMPTY.name]+(_numOfRows-fieldType.numOfItems)}),fields=fieldsType,ArrayUtils.IteratorOverKeys(fields,function(field){var max,tkey=(max=ArrayUtils.FindMinMax(field._inferredTypes,function(curval,lastval){return lastval<curval})).first.key;if(tkey===DataTypeConverter.TYPES.EMPTY.name&&null!=max.second&&void 0!==max.second&&(tkey=max.second.key),field.type=tkey,field.typeConfidence=field._inferredTypes[field.type]/field.numOfItems,void 0!==(max=ArrayUtils.FindMinMax(field._inferredSubTypes,function(curval,lastval){return lastval<curval}))&&null!=max&&void 0!==max.first&&null!=max.first&&max.first.key===DataTypeConverter.SUBTYPES.DATETIMEXXY.name&&void 0!==max.second&&null!=max.second){var temp=max.first;max.first=max.second,max.second=temp}if("undefined"!==max.second&&null!=max.second&&max.second.key===DataTypeConverter.SUBTYPES.DATETIMEXXY.name){var counter=0,valueToCompare=field._inferredSubTypes[max.first.key];for(var _key in field._inferredSubTypes)_key!==DataTypeConverter.SUBTYPES.DATETIMEXXY.name&&field._inferredSubTypes[_key]==valueToCompare&&counter++;1<counter&&(max.first=max.second,max.second=null)}if((field.subtype=null)!=max&&null!=max.first){field.subtype=max.first.key,field.subtypeConfidence=field._inferredSubTypes[field.subtype]/field.numOfItems;var fieldName=field.name.toLowerCase(),isLatType=field.subtype===DataTypeConverter.SUBTYPES.LATITUDE.name,fieldNameContainsLat=0<=fieldName.indexOf("lat"),fieldNameContainsLon=0<=fieldName.indexOf("ng");1==isLatType&&0==fieldNameContainsLat&&1==fieldNameContainsLon&&(field.subtype=DataTypeConverter.SUBTYPES.LONGITUDE.name)}});var quality={homogeneity:1,completeness:1,totalNullValues:0,totalValues:0};ArrayUtils.IteratorOverKeys(fieldsType,function(fieldType){quality.totalValues+=fieldType.numOfItems,quality.homogeneity*=fieldType.typeConfidence,fieldType.totalNullValues=0,fieldType._inferredTypes.hasOwnProperty(DataTypeConverter.TYPES.EMPTY.name)&&(fieldType.totalNullValues=fieldType._inferredTypes[DataTypeConverter.TYPES.EMPTY.name],quality.totalNullValues+=fieldType.totalNullValues)}),quality.homogeneity=Math.round(100*quality.homogeneity)/100;var totFullValues=quality.totalValues-quality.totalNullValues;quality.completeness=Math.round(totFullValues/quality.totalValues*100)/100,ArrayUtils.IteratorOverKeys(fieldsType,function(fieldType){var _type=fieldType.type,_lngkey=("key_type"+(fieldType.typeLabel=_type)).toLowerCase();JDC_LNG.hasOwnProperty(_lngkey)?(_entry=JDC_LNG[_lngkey]).hasOwnProperty(options.language)?fieldType.typeLabel=_entry[options.language]:console.warn("JSDatachecker translation not found. Language "+options.language+". Type "+_type):console.warn("JSDatachecker translation not found. Language "+options.language+". Type "+_type);var _subtype=fieldType.subtype;if(null!=(fieldType.subtypeLabel=_subtype)){var _entry;_lngkey=("key_subtype"+_subtype).toLowerCase();if(JDC_LNG.hasOwnProperty(_lngkey))(_entry=JDC_LNG[_lngkey]).hasOwnProperty(options.language)?fieldType.subtypeLabel=_entry[options.language]:console.warn("JSDatachecker translation not found. Language "+options.language+". Subtype "+_subtype);else console.warn("JSDatachecker translation not found. Language "+options.language+". Subtype "+_subtype)}});var warningsTextual="";ArrayUtils.IteratorOverKeys(fieldsType,function(fieldType){var description=fieldType.errorsDescription="";if(fieldType.typeConfidence<1){var incorrect=fieldType.numOfItems-fieldType._inferredTypes[fieldType.type];if(0<incorrect){var _descr1=_capitalizeFirstLetter(JDC_LNG.key_declaretype[options.language])+".",_descr2=_capitalizeFirstLetter(JDC_LNG.key_notoftype_singular[options.language])+".";1<incorrect&&(_descr2=_capitalizeFirstLetter(JDC_LNG.key_notoftype_plural[options.language])+".");var _descr3="",_LISTWRONGROS="";if(options.trackCellsForEachType){_descr3=_capitalizeFirstLetter(JDC_LNG.key_seewrongrows[options.language])+".";var keysWrongTypes=Object.keys(fieldType._inferredTypes).filter(function(typekey){return typekey.indexOf("_cells")<0&&0<fieldType._inferredTypes[typekey]&&typekey!==fieldType.type});fieldType.cellsWithWarnings=[];for(var iKeyType=0;iKeyType<keysWrongTypes.length;iKeyType++){var _keywrongtype=keysWrongTypes[iKeyType],_wrongcells=fieldType._inferredTypes[_keywrongtype+"_cells"];if(void 0!==_wrongcells)for(var icell=0;icell<_wrongcells.length;icell++){var _cell=_wrongcells[icell],_warningMessage=_capitalizeFirstLetter(JDC_LNG.key_declaretype[options.language])+". ";_warningMessage=(_warningMessage=(_warningMessage+=_capitalizeFirstLetter(JDC_LNG.key_cellnotoftype[options.language])+". ").replace(/%COL_NAME/g,fieldType.label)).replace(/%COL_TYPE/g,fieldType.type),_cell.warningMessage=_warningMessage,_keywrongtype===DataTypeConverter.TYPES.EMPTY.name&&(_cell.warningMessage=_capitalizeFirstLetter(JDC_LNG.key_emptycell[options.language])+"."),fieldType.cellsWithWarnings.push(_cell)}}for(iKeyType=0;iKeyType<keysWrongTypes.length;iKeyType++){var _keytype=keysWrongTypes[iKeyType],_cells=fieldType._inferredTypes[_keytype+"_cells"];if(void 0!==_cells)for(icell=0;icell<_cells.length;icell++){_LISTWRONGROS+=(_cell=_cells[icell]).rowIndex+2+"("+_keytype+")"+(icell==_cells.length-2?", and ":"")+(icell<_cells.length-2?", ":"")}}}description+=descr=(descr=(descr=(descr=(descr=_descr1+" "+_descr2+" "+_descr3).replace(/%COL_NAME/g,fieldType.label)).replace(/%COL_TYPE/g,fieldType.type)).replace(/%COL_ERRORS/g,incorrect)).replace(/%LIST_WRONG_ROWS/g,_LISTWRONGROS)}}if(fieldType.type===DataTypeConverter.TYPES.DATETIME.name)if(fieldType.subtype===DataTypeConverter.SUBTYPES.DATETIMEXXY.name)description+=" "+_capitalizeFirstLetter(JDC_LNG.key_dateformatunknown[options.language])+". ";else{var valuesNotInRecognizedFormat=fieldType.numOfItems-fieldType._inferredSubTypes[fieldType.subtype]-(fieldType.hasOwnProperty(DataTypeConverter.SUBTYPES.DATETIMEXXY.name)?fieldType._inferredSubTypes[DataTypeConverter.SUBTYPES.DATETIMEXXY.name]:0);if(0<valuesNotInRecognizedFormat)description+=descr=(descr=_capitalizeFirstLetter(JDC_LNG.key_datenotinformat[options.language])).replace(/%COL_NUMDATENOTINFORMAT/g,valuesNotInRecognizedFormat)}var descr="";1==fieldType.totalNullValues?descr=_capitalizeFirstLetter(JDC_LNG.key_emptyvalue_singolar[options.language])+".":1<fieldType.totalNullValues&&(descr=_capitalizeFirstLetter(JDC_LNG.key_emptyvalue_plural[options.language])+"."),description=(description=(description=(description=(description=description+" "+descr).replace(/%COL_NAME/g,fieldType.label)).replace(/%COL_TYPE/g,fieldType.type)).replace(/%COL_SUBTYPE/g,fieldType.subtypeLabel)).replace(/%COL_NULLVALUES/g,fieldType.totalNullValues),fieldType.errorsDescription=description.trim(),warningsTextual+=description.trim()});var metadata={dataset:json,fieldKeys:fieldKeys,types:fieldsType,qualityIndex:quality,warningsTextual:warningsTextual};return 1==options.filterOnThresholdConfidence&&function(metadata,threshold){ArrayUtils.IteratorOverKeys(metadata.types,function(fieldType,key){if(!(fieldType.typeConfidence>=threshold)){var arrHierarchyTypes=DataTypeHierarchy.HIERARCHY[fieldType.type];if(null==arrHierarchyTypes)return metadata;var lastFieldType={lastType:arrHierarchyTypes[0],lastTypeCounter:fieldType._inferredTypes[arrHierarchyTypes[0]],typeConfidence:0};lastFieldType.typeConfidence=lastFieldType.lastTypeCounter/fieldType.numOfItems;for(var curType,i=1;arrHierarchyTypes.length,curType=arrHierarchyTypes[i];i++){var numItemsOfCurType=fieldType._inferredTypes.hasOwnProperty(curType)?fieldType._inferredTypes[curType]:0;if(lastFieldType.lastType=curType,lastFieldType.lastTypeCounter+=numItemsOfCurType,lastFieldType.typeConfidence=lastFieldType.lastTypeCounter/fieldType.numOfItems,lastFieldType.typeConfidence>=threshold){fieldType.type=lastFieldType.lastType,fieldType.typeConfidence=lastFieldType.typeConfidence;break}}}})}(metadata,options.thresholdConfidence),metadata},inferDataTypeOfValue:function(value){return _processInferType(value)},inferDataSubTypeOfValue:function(value){return _processInferSubType(value)}}}(),DataTypesUtils.FilterTime=function(value){if(0==/^[0-9]{2}:[0-9]{2}(:[0-9]{2})?(\+[0-9]{2}:[0-9]{2})?$/.test(value))return null;var splitted=value.split(/[:|\+]/),expNumber=/^[0-9]{2}$/,HH=expNumber.test(splitted[0])?parseInt(splitted[0]):0,MM=expNumber.test(splitted[1])?parseInt(splitted[1]):0,SS=3<=splitted.length&&expNumber.test(splitted[2])?parseInt(splitted[2]):0,dt=new Date;return dt.setHours(HH),dt.setMinutes(MM),dt.setSeconds(SS),dt},DataTypesUtils.FilterDateTime=function(value){var _dtSplitted=value.split(/[T|\s]/);if(2==_dtSplitted.length)return null==(dtTime=DataTypesUtils.FilterTime(_dtSplitted[1]))?null:DataTypesUtils.FilterDate(_dtSplitted[0],dtTime);var dtTime,dtDate=DataTypesUtils.FilterDate(value);return null!=dtDate?dtDate:dtTime=DataTypesUtils.FilterTime(value)},DataTypesUtils.FilterDate=function(value,dtDate){if(null==dtDate&&(dtDate=new Date("YYYY-MM-DD")),/^[0-9]{1,4}(\-|\/)[0-9]{1,2}$/.test(value)){var splitted=value.split(/[\-|\/]/),year=parseInt(splitted[0]);return 12<(month=parseInt(splitted[1]))?null:(dtDate.setYear(year),dtDate.setMonth(month),{type:DataTypeConverter.TYPES.DATETIME,subtype:DataTypeConverter.SUBTYPES.DATETIMEYM,date:dtDate})}var expDate=/^[0-9]{1,4}(\-|\/)[0-9]{1,2}((\-|\/)[0-9]{1,2})?$/;if(expDate.test(value)){splitted=value.split(/[\-|\/]/),year=parseInt(splitted[0]);var month=parseInt(splitted[1]),day=3==splitted.length?parseInt(splitted[2]):0;return month<=0||13<=month?null:day<=0||32<=day?null:(dtDate.setYear(year),dtDate.setMonth(month),dtDate.setDate(day),{type:DataTypeConverter.TYPES.DATETIME,subtype:DataTypeConverter.SUBTYPES.DATETIMEYMD,date:dtDate})}if((expDate=/^[0-9]{1,2}(\-|\/)[0-9]{1,2}(\-|\/)[0-9]{1,4}$/).test(value)){splitted=value.split(/[\-|\/]/),year=parseInt(splitted[2]),month=parseInt(splitted[1]),day=parseInt(splitted[0]);var result={type:DataTypeConverter.TYPES.DATETIME,subtype:DataTypeConverter.SUBTYPES.DATETIMEDMY,date:dtDate};if(12<month){var temp=month;month=day,day=temp,result.subtype=DataTypeConverter.SUBTYPES.DATETIMEMDY}return month<=0||13<=month?null:day<=0||32<=day?null:(day<=12&&month<=12&&(result.subtype=DataTypeConverter.SUBTYPES.DATETIMEXXY),dtDate.setYear(year),dtDate.setMonth(month),dtDate.setDate(day),result)}return null},DataTypesUtils.FilterFloat=function(value){return/^(\-|\+)?((0|([1-9][0-9]*))(\.[0-9]+)?|Infinity)$/.test(value)?Number(value):NaN},DataTypesUtils.FilterPercentage=function(value){var index=(value=value.trim()).indexOf("%");if(index<0)return null;if(index!=value.length-1)return null;var _number=value.split("%")[0].trim(),number=DataTypesUtils.FilterNumber(_number);return isNaN(number)?null:{type:DataTypeConverter.TYPES.NUMBER,subtype:DataTypeConverter.SUBTYPES.PERCENTAGE,value:number}},DataTypesUtils.FilterNumber=function(value){var valnum=DataTypesUtils.FilterFloat(value);if(0==isNaN(valnum))return valnum;if("string"!=typeof value)return NaN;value.split(/(,|\.)/g);var idxDot={idx:value.indexOf("."),sym:"."},idxComma={idx:value.lastIndexOf(","),sym:","},idxFirst={};idxFirst=-1==idxDot.idx?idxComma:-1==idxComma.idx?idxDot:idxDot.idx<idxComma.idx?idxDot:idxComma;var idxLastDot={idx:value.lastIndexOf("."),sym:"."},idxLastComma={idx:value.lastIndexOf(","),sym:","},idxLast={};idxLast=-1==idxLastDot.idx?idxLastComma:-1==idxLastComma.idx?idxLastDot:idxLastComma.idx<idxLastDot.idx?idxLastDot:idxLastComma;var splitted=value.split(/(\.|,|\-|\+)/g);if(0==splitted.length)return NaN;var str,i=0;for("-"!=splitted[0]&&"+"!=splitted[0]||(i=1);splitted.length,str=splitted[i];i++)if("."==str)0;else if(","==str)0;else if(0==/^(0|([0-9]+))$/g.test(str))return NaN;var lastValue=splitted[splitted.length-1];if("."==lastValue||","==lastValue||0==lastValue.length)return NaN;if(-1==idxFirst.idx&&-1==idxLast.idx)return DataTypesUtils.FilterFloat(value);if(idxFirst.idx==idxLast.idx&&"."==idxFirst.sym)return Number(value);if(idxFirst.idx!=idxLast.idx||","!=idxFirst.sym)return NaN;var nval=value.replace(",",".");return Number(nval)},DataTypesUtils.DecimalPlaces=function(num){var match=(""+num).match(/(?:\.(\d+))?(?:[eE]([+-]?\d+))?$/);return match?Math.max(0,(match[1]?match[1].length:0)-(match[2]?+match[2]:0)):0},DataTypesUtils.IsLatLng=function(num){return NaN!=DataTypesUtils.FilterFloat(num)&&4<DataTypesUtils.DecimalPlaces(num)},DataTypeHierarchy.HIERARCHY=[],DataTypeHierarchy.HIERARCHY[DataTypeConverter.TYPES.TEXT.name]=[DataTypeConverter.TYPES.TEXT.name],DataTypeHierarchy.HIERARCHY[DataTypeConverter.TYPES.NUMBER.name]=[DataTypeConverter.TYPES.NUMBER.name,DataTypeConverter.TYPES.TEXT.name],DataTypeHierarchy.HIERARCHY[DataTypeConverter.TYPES.DATETIME.name]=[DataTypeConverter.TYPES.DATETIME.name,DataTypeConverter.TYPES.TEXT.name],DataTypeHierarchy.HIERARCHY[DataTypeConverter.SUBTYPES.GEOCOORDINATE.name]=[DataTypeConverter.SUBTYPES.GEOCOORDINATE.name,DataTypeConverter.TYPES.NUMBER.name,DataTypeConverter.TYPES.TEXT.name],DataTypeHierarchy.HIERARCHY[DataTypeConverter.SUBTYPES.PERCENTAGE.name]=[DataTypeConverter.SUBTYPES.PERCENTAGE.name,DataTypeConverter.TYPES.NUMBER.name,DataTypeConverter.TYPES.TEXT.name],DataTypeHierarchy.canConvert=function(fromType,toType){return 0<=DataTypeHierarchy.HIERARCHY[fromType].indexOf(toType)};var JDC_LNG={key_declaretype:{EN:"the column '%COL_NAME' is of type '%COL_TYPE'",IT:"la colonna '%COL_NAME' è di tipo '%COL_TYPE'",FR:"le colonne '%COL_NAME' est de type '%COL_TYPE'",NL:"de kolom '%COL_NAME' is van het type '%COL_TYPE'"},key_notoftype_singular:{EN:"a value is not '%COL_TYPE'",IT:"un valore non è un '%COL_TYPE'",FR:"La valeur n'est pas '%COL_TYPE'",NL:"een waarde is niet '%COL_TYPE'"},key_cellnotoftype:{EN:"the cell value is not '%COL_TYPE'",IT:"il valore della cella non è di tipo '%COL_TYPE'",FR:"the cell value is not '%COL_TYPE'",NL:"the cell value is not '%COL_TYPE'"},key_notoftype_plural:{EN:"%COL_ERRORS values are not '%COL_TYPE'",IT:"%COL_ERRORS valori non sono di tipo '%COL_TYPE'",FR:"%COL_ERRORS les valeurs ne sont pas de type '%COL_TYPE'",NL:"%COL_ERRORS waarden niet '%COL_TYPE'"},key_emptyvalue_singolar:{EN:"the column '%COL_NAME' has an empty value",IT:"la colonna '%COL_NAME' ha un valore vuoto",FR:"La colonne '%COL_NAME'  a une valeur vide",NL:"de kolom '%COL_NAME' heeft een lege waarde"},key_emptycell:{EN:"the cell is empty",IT:"la cella è vuota",FR:"the cell is empty",NL:"the cell is empty"},key_emptyvalue_plural:{EN:"the column '%COL_NAME' has '%COL_NULLVALUES' empty values",IT:"la colonna '%COL_NAME' ha '%COL_NULLVALUES' valori vuoti",FR:"La colonne '%COL_NAME' a la valeur '%COL_NULLVALUES' qui est vide",NL:"de kolom '%COL_NAME' heeft '%COL_NULLVALUES' lege waarde"},key_seewrongrows:{EN:"check rows '%LIST_WRONG_ROWS'",IT:"controlla le righe '%LIST_WRONG_ROWS'",FR:"check rows '%LIST_WRONG_ROWS'",NL:"check rows '%LIST_WRONG_ROWS'"},key_type:{EN:"type",IT:"tipo",FR:"type",NL:"type"},key_subtype:{EN:"subtype",IT:"sottotipo",FR:"sous-type",NL:"subtype"},key_typetext:{EN:"text",IT:"testo",FR:"texte",NL:"tekst"},key_typenumber:{EN:"number",IT:"numero",FR:"chiffres",NL:"aantal"},key_typeobject:{EN:"object",IT:"oggetto",FR:"objet",NL:"voorwerp"},key_typedatetime:{EN:"date or time",IT:"data o orario",FR:"date ou l'heure",NL:"datum of tijd"},key_typeempty:{EN:"empty",IT:"vuoto",FR:"vide",NL:"leeg"},key_typenull:{EN:"empty",IT:"vuoto",FR:"vide",NL:"leeg"},key_typelatitude:{EN:"latitude",IT:"latitudine",FR:"latitude",NL:"breedtegraad"},key_typelongitude:{EN:"longitude",IT:"longitudine",FR:"longitude",NL:"lengtegraad"},key_subtypegeocoordinate:{EN:"coordinate",IT:"coordinate",FR:"coordonnées",NL:"coordinate"},key_subtypegeojson:{EN:"geojson",IT:"geojson",FR:"geojson",NL:"geojson"},key_subtypebool:{EN:"bool",IT:"bool",FR:"bool",NL:"bool"},key_subtypeconst:{EN:"const",IT:"costante",FR:"const",NL:"const"},key_subtypecategory:{EN:"category",IT:"categoria",FR:"category",NL:"category"},key_subtypepercentage:{EN:"percentage",IT:"percentuale",FR:"percentage",NL:"percentage"},key_subtypelatitude:{EN:"latitude",IT:"latitudine",FR:"latitude",NL:"latitude"},key_subtypelongitude:{EN:"longitude",IT:"longitudine",FR:"longitude",NL:"longitude"},key_subtypedatetimeymd:{EN:"YYYY/MM/DD",IT:"YYYY/MM/DD",FR:"YYYY/MM/DD",NL:"YYYY/MM/DD"},key_subtypedatetimedmy:{EN:"DD/MM/YYYY",IT:"DD/MM/YYYY",FR:"DD/MM/YYYY",NL:"DD/MM/YYYY"},key_subtypedatetimexxy:{EN:"D?M/D?M/YYYY",IT:"D?M/D?M/YYYY",FR:"D?M/D?M/YYYY",NL:"D?M/D?M/YYYY"},key_subtypenuminteger:{EN:"integer number",IT:"numero intero",FR:"integer number",NL:"integer number"},key_subtypenumreal:{EN:"real number",IT:"numero reale",FR:"real number",NL:"real number"},key_subtypeinteger:{EN:"integer number",IT:"numero intero",FR:"integer number",NL:"integer number"},key_subtypereal:{EN:"real number",IT:"numero reale",FR:"real number",NL:"real number"},key_dateformatunknown:{EN:"Cannot determine the date format for the column '%COL_NAME'",IT:"Impossibile determinare il formato della data per la colonna '%COL_NAME'",FR:"Cannot determine the date format for the column '%COL_NAME'",NL:"Cannot determine the date format for the column '%COL_NAME'"},key_datenotinformat:{EN:"'%COL_NUMDATENOTINFORMAT' values of the column '%COL_NAME' are not in format '%COL_SUBTYPE'",IT:"'%COL_NUMDATENOTINFORMAT' valori della colonna '%COL_NAME' non sono in formato '%COL_SUBTYPE'",FR:"'%COL_NUMDATENOTINFORMAT' values of the column '%COL_NAME' are not in format '%COL_SUBTYPE'",NL:"'%COL_NUMDATENOTINFORMAT' values of the column '%COL_NAME' are not in format '%COL_SUBTYPE'"}};function DataTypeHelper(){}DataTypeHelper.forEachType=function(metadata,callback){for(var keys=Object.keys(metadata.types),i=0;i<keys.length;i++){var key=keys[i];callback(metadata.types[key])}};var _converter = function(obj) { return new DataTypeConverter(); }; 
module.exports = _converter; 
}); 
